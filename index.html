<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Notas Estudiantiles</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Estilos anteriores se mantienen igual */
    </style>
</head>
<body>
    <!-- Todo el contenido HTML anterior se mantiene igual -->
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Todo el código anterior se mantiene igual hasta la función de exportación
            
            // Exportar a Excel (optimizado para LibreOffice)
            exportButton.addEventListener('click', function() {
                saveCurrentStudent();
                
                // Preparar datos
                const data = [
                    ["Estudiante", "5to", "6to", "7mo", "8vo", "9no", "10mo", "1ero", "2do", "3ero", "PPE", "Observación"]
                ];
                
                students.forEach((student, index) => {
                    const notesData = studentNotes[index];
                    data.push([
                        student,
                        ...notesData.notes,
                        notesData.observations
                    ]);
                });
                
                // Crear libro de Excel
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(data);
                
                // Ajustar anchos de columnas (MODIFICADO PARA COLUMNAS MÁS ANCHAS)
                ws['!cols'] = [
                    {wch: 40},  // Columna de estudiantes más ancha (antes era 30)
                    {wch: 6},   // 5to
                    {wch: 6},   // 6to
                    {wch: 6},   // 7mo
                    {wch: 6},   // 8vo
                    {wch: 6},   // 9no
                    {wch: 6},   // 10mo
                    {wch: 6},   // 1ero
                    {wch: 6},   // 2do
                    {wch: 6},   // 3ero
                    {wch: 6},   // PPE
                    {wch: 40}   // Observación
                ];
                
                XLSX.utils.book_append_sheet(wb, ws, "Notas");
                
                // Exportar con formato compatible con LibreOffice
                XLSX.writeFile(wb, "notas_estudiantiles.xlsx", {
                    bookType: 'xlsx',
                    type: 'array'
                });
            });
            
            // Resto del código se mantiene igual
        });
    </script>
</body>
</html>
